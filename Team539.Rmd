---
title: "Presidential Election Maps for United Sates from 1920s"
author: "Team FiveThirtyNine"
date: "12/3/2017"
output: html_document
---
# Libraries Needed
```{r, message=F}
library(stringr)
library(dplyr)
library(tidyr)
library(shiny)
library(rvest)
```

```{r}
#here's an basic scrape for 1924 election
html_str <- "https://en.wikipedia.org/wiki/United_States_presidential_election,_1924#Results_by_state"
## web_url is the same, just replace 1924 for another yr for a different election ##

page <- read_html(html_str)
raw_table <- page %>% 
  html_nodes(xpath = '//*[@id="mw-content-text"]/div/table[15]') %>% html_table()
## Problem: the xpath is not constant across all years ##
## The selector for the tables doesn't appear to be consistent across pages either ##

raw_table <- raw_table[[1]]
View(raw_table)

## perhaps this is a solution? ##
xp <- c('//*[@id="mw-content-text"]/div/div[24]/table','//*[@id="mw-content-text"]/div/div[16]/table','//*[@id="mw-content-text"]/div/div[24]/table','//*[@id="mw-content-text"]/div/div[22]/table','//*[@id="mw-content-text"]/div/div[39]/table')

yr <- c("2000","2004","2008","2012","2016")

xpath <- as.list(setNames(xp,yr))
```


# Scraping Data from Wikipedia
```{r}
get_election_data=function(year){
  html_str <- paste0("https://en.wikipedia.org/wiki/United_States_presidential_election,_",year,"#Results_by_state")
  
  page <- read_html(html_str)
  raw_table <- page %>% 
    html_nodes(xpath = xpath[[as.character(year)]]) %>% html_table()
  
  raw_table <- raw_table[[1]]
  
}
```

# Shiny App
```{r}

```
